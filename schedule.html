<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ì—¬í–‰ ì¼ì • ìƒì„±ê¸°</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .input-box { margin-bottom: 15px; }
        input, button {
            padding: 10px; font-size: 16px;
            width: 100%; margin-bottom: 10px;
        }
        button { background: #007bff; color: white; border: none; cursor: pointer; }
        button:hover { background: #0056b3; }

        h2 { margin-top: 30px; }

        .day-box { margin-bottom: 25px; }

        .schedule-item {
            background: #f5f5f5;
            padding: 10px; border-radius: 8px;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>

    <h1>ğŸ§­ ì—¬í–‰ ì¼ì • ìë™ ìƒì„±</h1>

    <div class="input-box">
        <label>ì—¬í–‰ì§€ ëª©ë¡ (ì‰¼í‘œë¡œ êµ¬ë¶„):</label>
        <input id="places" placeholder="ì˜ˆ: ì„œìš¸, ë¶€ì‚°, ì œì£¼ë„">
    </div>

    <div class="input-box">
        <label>ì—¬í–‰ ê¸°ê°„ (ì¼):</label>
        <input id="days" type="number" value="3">
    </div>

    <div class="input-box">
        <label>ì˜ˆì‚° (ì›):</label>
        <input id="budget" type="number" value="300000">
    </div>

    <button onclick="generateSchedule()">ì¼ì • ìƒì„±</button>

    <div id="result" style="margin-top: 20px;"></div>

<script>
// =========================
// ğŸ”¹ ì—¬í–‰ ì¼ì • ìƒì„± ìš”ì²­
// =========================
async function generateSchedule() {
    const placesInput = document.getElementById("places").value.trim();
    const days = document.getElementById("days").value;
    const budget = document.getElementById("budget").value;

    if (!placesInput) {
        alert("ì—¬í–‰ì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”.");
        return;
    }

    const places = placesInput.split(",").map(p => p.trim());

    const body = {
        places: places,         // ğŸ”¥ í•œê¸€ ì…ë ¥ ê·¸ëŒ€ë¡œ ì„œë²„ë¡œ ì „ì†¡
        days: parseInt(days),
        budget: parseInt(budget) // ğŸ”¥ ì›í™” ì „ë‹¬
    };

    document.getElementById("result").innerHTML = "<p>ì¼ì • ìƒì„± ì¤‘... ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”!</p>";

    try {
        const res = await fetch("/api/plan_trip", {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify(body)
        });

        const data = await res.json();
        console.log("ì—¬í–‰ ì¼ì • ë°ì´í„°:", data);

        renderSchedule(data);

    } catch (error) {
        console.error(error);
        document.getElementById("result").innerHTML = "<p>ì˜¤ë¥˜ ë°œìƒ</p>";
    }
}

// =========================
// ğŸ”¹ ì¼ì • HTML ë Œë”ë§
// =========================
function renderSchedule(data) {
    let html = "";

    data.forEach(day => {
        html += `
        <h2>ğŸ“… Day ${day.day}</h2>
        <div class="day-box">
        `;

        day.schedule.forEach(item => {
            html += `
            <div class="schedule-item">
                <p><strong>${item.time}</strong></p>
                <p>${item.activity}</p>
            </div>`;
        });

        html += `</div>`;
    });

    document.getElementById("result").innerHTML = html;
}
</script>

</body>
</html>
